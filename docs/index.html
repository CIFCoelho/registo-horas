<!doctype html>
<meta charset="utf-8">
<title>Registo de Horas</title>
<style>
  body{font-family:sans-serif;max-width:480px;margin:0 auto;padding:1rem}
  label{display:block;margin-top:8px}
  button{margin-top:12px;font-size:1.2rem;width:100%}
</style>

<form id="f">
  <label>Funcionário <input name="funcionario" required></label>
  <label>Secção
    <select name="secao">
      <option>Estufagem</option><option>Acabamentos</option>
    </select>
  </label>
  <label>Nº O.F. <input name="of" required></label>
  <label>Início <input name="inicio" type="time" required></label>
  <label>Fim <input name="fim" type="time" required></label>
  <button>Guardar</button>
</form>

<script>
  (function () {
    var URL = "https://script.google.com/macros/s/AKfycbx_Bq2s-seCS5vk7HbpiV_fHSSu2-2rtrM1zS72Mvs/dev";
  
    var form = document.getElementById('f');
  
    form.onsubmit = function (e) {
      e.preventDefault();
  
      var data = {};
      Array.prototype.forEach.call(form.elements, function (el) {
        if (el.name) data[el.name] = el.value;
      });
  
      var xhr = new XMLHttpRequest();
      xhr.open('POST', URL, true);
      xhr.setRequestHeader('Content-Type', 'text/plain');
  
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            alert('Registo guardado!');
            form.reset();
          } else {
            alert('Erro ao enviar: ' + xhr.status);
          }
        }
      };
  
      xhr.send(JSON.stringify(data));
    };
  })();
  </script>
